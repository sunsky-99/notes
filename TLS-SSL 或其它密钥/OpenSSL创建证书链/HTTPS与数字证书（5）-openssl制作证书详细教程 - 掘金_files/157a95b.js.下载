(window.webpackJsonp=window.webpackJsonp||[]).push([[159],{2735:function(t,e,o){},4240:function(t,e,o){t.exports=o.p+"c794682f2184652c07e62d648e048460.svg"},4241:function(t,e,o){t.exports=o.p+"00ba359ecd0075e59ffbc3d810af551d.svg"},4242:function(t,e,o){t.exports=o.p+"336af4d1fafabcca3b770c8ad7a50781.svg"},4243:function(t,e,o){t.exports=o.p+"e371749f308e0d99430a6a4943eef946.svg"},4244:function(t,e,o){t.exports=o.p+"3d482c7a948bac826e155953b2a28a9e.svg"},4245:function(t,e,o){"use strict";o(2735)},4453:function(t,e,o){"use strict";o.r(e);o(19),o(17),o(14),o(7),o(16);var n=o(0),c=o(5),r=o(73),l=o(8),d=o(240),_=o(1353),v=o(1441),f=o(165),y=o(3),m=o(871),h=o(56),O=o(306);function C(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(object);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,o)}return e}function P(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?C(Object(source),!0).forEach((function(e){Object(n.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):C(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var j=Object(c.b)({components:{CollectPopupList:_.a},inject:["getRecommendScoreInfo","getFromPage"],props:{entry:{type:Object},fromPage:{type:String,default:""}},setup:function(){return Object(v.a)()},data:function(){return{likeLock:Object(m.a)(),isCollectPopupVisible:!1}},computed:{collectText:function(){return"".concat(this.entry.collected?"已":"","收藏")},currentUser:function(){var t;return(null===(t=this.$store.state.auth)||void 0===t?void 0:t.user)||{}}},methods:{togglePraise:function(){var t=this;this.likeLock.do((function(){return t.$ensureAuthorized().then((function(){return t.$ensureBindPhone({bindLabel:f.b.interact})})).then((function(){var e,o,n,c,r,l,d,_,v,f,y;t.$TEA("item_like_click",P(P({event_page:h.a.articleDetail,req_id:null===(e=t.entry)||void 0===e?void 0:e.req_id,boost_type:null===(n=null===(o=t.entry)||void 0===o?void 0:o.extra)||void 0===n?void 0:n.boost_type,category_id:null===(r=null===(c=t.entry)||void 0===c?void 0:c.category)||void 0===r?void 0:r.category_id,from_page:Object(h.b)(t.fromPage),from_page_type:Object(h.c)(),item_id:null===(l=t.entry)||void 0===l?void 0:l.article_id,item_type:2,item_author_id:null===(_=null===(d=t.entry)||void 0===d?void 0:d.author_user_info)||void 0===_?void 0:_.user_id,from_item_id:null===(v=t.entry)||void 0===v?void 0:v.article_id,from_item_type:2,action:(null===(f=t.entry)||void 0===f?void 0:f.liked)?1:2},Object(O.c)(t.entry)),null===(y=t.getRecommendScoreInfo)||void 0===y?void 0:y.call(t)))})).then((function(){return t.$store.dispatch(y.TOGGLE_LIKE_ENTRY,t.entry).catch((function(e){t.$error("操作失败, 请稍后重试"),console.error(e)}))})).catch((function(t){console.error(t)}))}))},linkToMobileCollection:function(){var t,e,o,n,c,_,v=this,f=null===(t=this.entry)||void 0===t?void 0:t.article_id;this.$TEA("collection_click",P({item_id:f,category_id:null===(o=null===(e=this.entry)||void 0===e?void 0:e.category)||void 0===o?void 0:o.category_id,item_author_id:null===(c=null===(n=this.entry)||void 0===n?void 0:n.author_user_info)||void 0===c?void 0:c.user_id,enter_from:"bottom_bar"},null===(_=this.getRecommendScoreInfo)||void 0===_?void 0:_.call(this))),this.$ensureAuthorized().then((function(){var t,e;if(v.entry.collected){var o=P({item_id:v.entry.article_id,category_id:v.entry.category_id,item_author_id:v.entry.author_user_id,from_page:Object(h.b)(v.fromPage),collection_list_ids:"",action:"0"},null===(t=v.getRecommendScoreInfo)||void 0===t?void 0:t.call(v));return v.$TEA("collection_list_save",o),void d.a.DeleteArticleFromCollection({article_id:f}).then((function(t){(null==t?void 0:t.err_no)===l.ERROR_NO.OK&&(r.Message.success("取消收藏"),v.handleCollect(!1))}))}if(v.currentUser.is_collect_fast){var n=P({item_id:v.entry.article_id,category_id:v.entry.category_id,item_author_id:v.entry.author_user_id,collection_list_ids:"",action:"1",from_page:Object(h.b)(v.fromPage)},null===(e=v.getRecommendScoreInfo)||void 0===e?void 0:e.call(v));return v.$TEA("collection_list_save",n),v.collectPopoverVisible=!0,void d.a.AddArticleToCollection({article_id:f,is_collect_fast:!0}).then((function(t){(null==t?void 0:t.err_no)===l.ERROR_NO.OK&&(v.handleCollect(!0),r.Message.success("收藏成功"))})).catch((function(t){r.Message.error(null==t?void 0:t.message)}))}v.isCollectPopupVisible=!v.isCollectPopupVisible})).catch((function(t){console.log(t)}))},handleCollect:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$store.commit("view/column/UPDATE_STATE",{entry:P(P({},this.entry),{},{collected:t})})},onCollectSuccess:function(t,e){var o=this;this.isCollectPopupVisible=!1,this.handleCollect(!0),e.map((function(t){var e,n=P({item_id:o.entry.article_id,category_id:o.entry.category_id,item_author_id:o.entry.author_user_id,collection_list_ids:t,action:"1",from_page:Object(h.b)(o.fromPage)},null===(e=o.getRecommendScoreInfo)||void 0===e?void 0:e.call(o));o.$TEA("collection_list_save",n)}))}}}),k=(o(4245),o(29)),component=Object(k.a)(j,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"action-box"},[n("div",{staticClass:"praise-action action",class:{active:t.entry.liked},on:{click:t.togglePraise}},[n("div",{staticClass:"action-title-box"},[t.dynamicDataReady&&t.entry.liked?[n("img",{attrs:{src:o(4240)}})]:[n("img",{attrs:{src:o(4241)}})],t._v(" "),n("span",{staticClass:"action-title"},[t.dynamicDataReady?[t.entry.likedCount?[t._v("\n            "+t._s(t._f("formatTenThousand")(t.entry.likedCount))+"\n          ")]:[t._v("赞")]]:t._e()],2)],2)]),t._v(" "),n("div",{staticClass:"comment-action action",on:{click:function(e){return t.$emit("comment")}}},[n("div",{staticClass:"action-title-box"},[n("img",{attrs:{src:o(4242)}}),t._v(" "),n("span",{staticClass:"action-title"},[t.dynamicDataReady?[t.entry.commentsCount?[t._v("\n            "+t._s(t._f("formatTenThousand")(t.entry.commentsCount))+"\n          ")]:[t._v("评论")]]:t._e()],2)])]),t._v(" "),n("div",{staticClass:"collect-action action",on:{click:t.linkToMobileCollection}},[n("div",{staticClass:"action-title-box"},[t.dynamicDataReady&&t.entry.collected?[n("img",{attrs:{src:o(4243)}})]:[n("img",{attrs:{src:o(4244)}})],t._v(" "),n("span",{staticClass:"action-title"},[t._v("\n        "+t._s(t.dynamicDataReady?t.collectText:"")+"\n      ")])],2)]),t._v(" "),n("collect-popup-list",{attrs:{visible:t.isCollectPopupVisible,"article-id":t.entry&&t.entry.article_id||"","is-edit":t.entry.collected},on:{close:function(e){t.isCollectPopupVisible=!1},success:t.onCollectSuccess}})],1)}),[],!1,null,"31e92688",null);e.default=component.exports}}]);
//# sourceMappingURL=157a95b.js.map